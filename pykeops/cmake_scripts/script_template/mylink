# args :
# 1 - template file name
# 2 - keops template formula file name
# 3 - keops formula name

mkdir $3

g++ -Wall -ferror-limit=2 -O3 -DNDEBUG -O3 -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX10.15.sdk -bundle -Wl,-headerpad_max_install_names -Wl,-rpath,@loader_path/. -Xlinker -undefined -Xlinker dynamic_lookup -flto -o $3/$1.cpython-38-darwin.so $1.o -Wl,-rpath,build $2

/Library/Developer/CommandLineTools/usr/bin/strip -x $3/$1.cpython-38-darwin.so


